<!DOCTYPE html>
<!-- saved from url=(0064)https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx -->
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="WT.seg_1" content="zh-cn"><link rel="canonical" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx">
    <title>如何：对工作流和工作流服务启用 SQL 持久性</title>







<meta name="DCS.dcsuri" content="/zh-cn/library/ee395773(d=default,l=zh-cn,v=vs.110).aspx">

<meta name="NormalizedUrl" content="https://msdn.microsoft.com/zh-cn/library/ee395773(d=default,l=zh-cn,v=vs.110).aspx">

<meta name="ms.normalizedurl" content="https://msdn.microsoft.com/zh-cn/library/ee395773(d=default,l=zh-cn,v=vs.110).aspx">

<meta name="ms.prod" content=".net-framework-4.6">

<meta name="ms.devlang" content="dotnet">

<meta name="ms.topic" content="article">

<meta name="AmbientContext" content="{&quot;layout.limit_max_width&quot;:true,&quot;AmbientContextId&quot;:&quot;CA2FFE30-2386-4D76-ABB0-0D7E75684AA1&quot;,&quot;display.use_large_font&quot;:true,&quot;insight.perf_timing&quot;:true,&quot;AmbientContextDownstream&quot;:{},&quot;display.high_contrast&quot;:false,&quot;insight.use_wedcs_vnext&quot;:true}">

<meta name="VotingContextUrl" content="https://msdn.microsoft.com/zh-cn/library/ee395773(d=default,l=zh-cn,v=vs.110).aspx">

<meta name="MN" content="61C41DD1-6:34:46 AM">

<meta name="Search.ShortId" content="ee395773">

<meta name="ms.shortidmsdn" content="ee395773">

<meta name="ms.locale" content="zh-cn">

<meta name="ms.prodver" content="VS.110">

<meta name="ms.contentlang" content="ZH">

<meta name="ms.lang" content="ZH">

<meta name="ms.loc" content="CN">

<meta name="ms.sitever" content="2016.06.23.2">

<meta name="ms.assetid" content="ca7bf77f-3e5d-4b23-b17a-d0b60f46411d">

<meta name="ms.auth" content="0">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
        









    <script type="text/javascript" src="https://az416426.vo.msecnd.net/scripts/a/ai.0.js" async=""></script><script type="text/javascript" data-do-not-move="true">
        //<![CDATA[
        var AmbientContext = null;

        (function(){
            var root = (function(){return this;}).call(null);

            var GetCookie = function(name){
                var cookies = root.document.cookie ? root.document.cookie.split('; ') : [];
                for (var i = 0; i < cookies.length; i++) {
                    var pos = cookies[i].indexOf('=');
                    if (name === root.decodeURIComponent(cookies[i].slice(0, pos)))
                    {
                        var cookie = cookies[i].slice(pos + 1).replace(/\+/g, ' ');
                        cookie = root.decodeURIComponent(cookie);
                        return cookie;
                    }
                }
            };

            var JsonDeserialize = function(content) {
                return root.JSON && root.JSON.parse ? root.JSON.parse(content) : (new Function('return (' + content + ')'))();
            };

            try {
                AmbientContext = GetCookie('AmbientContext');
                AmbientContext = AmbientContext && JsonDeserialize(AmbientContext);
            } catch(ex) {
            } finally {
                AmbientContext = AmbientContext || null;
            }
        })();
        //]]>
    </script>

    <script type="text/javascript" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/jquery-1.9.1.min.js" data-do-not-move="true" data-provides="jQuery"></script>
    
<link rel="stylesheet" type="text/css" href="./如何：对工作流和工作流服务启用 SQL 持久性_files/Combined.css"><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"ttf": "https://i-msdn.sec.s-msft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected">try {
//

        window.appInsightsId = '5eb1b2eb-c47a-497a-a7ac-a1c230b2882f';
        //
} finally { MTPS._injectNextScript_1 && MTPS._injectNextScript_1(); }</script><script class="mtps-injected" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/Combined.js"></script><link href="./如何：对工作流和工作流服务启用 SQL 持久性_files/PrintView.css" rel="stylesheet" type="text/css" media="print"><meta name="ms.layout_limit_max_width" content="true"><meta name="ms.AmbientContextId" content="CA2FFE30-2386-4D76-ABB0-0D7E75684AA1"><meta name="ms.display_use_large_font" content="true"><meta name="ms.insight_perf_timing" content="true"><meta name="ms.AmbientContextDownstream" content="%7B%7D"><meta name="ms.display_high_contrast" content="false"><meta name="ms.insight_use_wedcs_vnext" content="true"><meta name="ms.perf.timing" content=",,0,71,1896,1896,6258,7253,6262,7442,7442,7880,,,"><script type="text/javascript" src="https://i.s-microsoft.com/wedcs/ms.js"></script><script type="text/javascript" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/jsll-3.2.0.js"></script><script class="mtps-injected" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/SearchBox.jss"></script><script class="mtps-injected" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/JumpRedirect.js"></script><script class="mtps-injected">try {
//
    MTPS = window.MTPS || {};
    MTPS.Translation = window.MTPS.Translation || {};

    MTPS.Translation.TranslationType =  0;
    
    
        
        MTPS.Translation.EditorLink = {
            includeEditor : 0,
            editLink: "https://msdn.microsoft.com/zh-cn/library/translation/edit/ee395773(v=vs.110).aspx",
            editLinkText: "建议更好的翻译"
        };
        
    //
} finally { MTPS._injectNextScript_5 && MTPS._injectNextScript_5(); }</script><script class="mtps-injected" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/Combined(1).js"></script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_7 && MTPS._injectNextScript_7(); }</script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = '展开'; MTPS.LocalizedStrings.CollapseButtonTooltip = '折叠'; MTPS.LocalizedStrings.EnhancedExpandTooltip = '单击以展开。双击以全部展开。'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = '单击以折叠。双击以全部折叠。'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = '全部展开'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = '全部折叠';
} finally { MTPS._injectNextScript_8 && MTPS._injectNextScript_8(); }</script><script class="mtps-injected" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/Combined(2).js"></script><script src="https://www.microsoft.com/library/svy/sto/https/broker.js"></script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_10 && MTPS._injectNextScript_10(); }</script></head>
<body class="library Chrome" youdao="bind">
    <div id="page">

        

        
    

    
    <link type="text/css" rel="stylesheet">
    
        
        
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn" data-device-type="desktop">
        

      <header ms.pgarea="header">
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                <a class="msdnLogoImg" href="https://msdn.microsoft.com/zh-cn" title="MSDN home">
                  <div id="msft-logo" class="msft-logo"></div>
                </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/zh-cn">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/zh-cn">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <div class="profileImage"></div>



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=12&amp;ct=1468416886&amp;rver=6.7.6640.0&amp;wp=mcmbi&amp;wlcxt=msdn%24msdn%24msdn&amp;wreply=https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2fee395773%2528v%3dvs.110%2529.aspx&amp;lc=2052&amp;id=254354&amp;mkt=zh-cn">登录</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">MSDN 订阅</span>
  </a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&amp;clcid=0x804&amp;slcid=0x804&amp;campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">
    <span style="line-height:18px;" xmlns="">获取工具</span>
  </a>
</div>
                  </div>
                        <div>
                            <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="http://www.weibo.com/cnmsdn" id="SocialLinks_2152_8" class="weiboShare" xmlns="http://www.w3.org/1999/xhtml">http://www.weibo.com/cnmsdn</a>
      </li>
      <li>
        <a href="http://aka.ms/msdnwechat" id="SocialLinks_2152_9" class="wechatShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/msdnwechat</a>
      </li>
      <li>
        <a href="http://aka.ms/contactmsdn" id="SocialLinks_2152_10" class="cnContactShare" xmlns="http://www.w3.org/1999/xhtml">http://aka.ms/contactmsdn</a>
      </li>
    </ul>
  </div>
</div>
                        </div>
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop" style="display: none;">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1" ms.cmpgrp="main nav">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">技术</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="云">云</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="应用开发">应用开发</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="数据">数据</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="游戏">游戏</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/internetofthings" title="物联网">物联网</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">下载</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions/" title="MSDN 订阅访问">MSDN 订阅访问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDK">SDK</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="试用软件">试用软件</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="免费下载">免费下载</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office 资源">Office 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 资源">SharePoint Server 2013 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express 资源">SQL Server 2014 Express 资源</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 资源">Windows Server 2012 资源</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">计划</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN 订阅">MSDN 订阅</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="权益">权益</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="学生">学生</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft 学生合作伙伴">Microsoft 学生合作伙伴</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="架构师">架构师</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="概述">概述</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="案例研究">案例研究</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="蓝图">蓝图</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="博客">博客</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&amp;sort=relevancedesc&amp;searchterm=architecture+or+architect" title="论坛">论坛</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/applicationbuilder" title="ISV">ISV</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="新手">新手</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="TechRewards">TechRewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/zh-cn" title="Events（事件）">Events（事件）</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)">社区</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="论坛">论坛</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://blogs.msdn.microsoft.com/" title="博客">博客</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/zh-cn" title="技术顾问">技术顾问</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="第 9 频道">第 9 频道</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)">文档</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="API 和参考">API 和参考</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="开发人员中心">开发人员中心</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/">示例</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button" ms.interactiontype="2" ms.title="search" ms.pgarea="header" ms.searchtype="icon">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none" data-searchtype="icon" data-pgarea="header" title="搜索 MSDN" ms.interactiontype="2" ms.title="search" ms.pgarea="header" ms.searchtype="icon"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0px; display: none;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)" autocomplete="off" data-searchtype="searchbox" data-pgarea="header" ms.interactiontype="2" ms.title="search" ms.pgarea="header" ms.searchtype="enter-key">
      <div id="SearchFlyoutContainer" style="display: none; text-align: left; border: 1px solid buttonshadow; position: absolute; z-index: 1000; padding: 2px; color: rgb(255, 255, 255); font-family: &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, SimSun, &quot;Segoe UI&quot;, &quot;Lucida Grande&quot;, Verdana, Arial, Helvetica, sans-serif; font-size: 16px; background-color: rgb(255, 255, 255);"><div id="SuggestionContainer"><ul data-pgarea="header" data-searchtype="search dropdown" ms.interactiontype="2" ms.title="search" ms.pgarea="header" ms.searchtype="suggested keyword" style="list-style: none; padding: 4px 2px 0px 1px; cursor: pointer; margin: 1px; white-space: nowrap;"></ul></div></div></div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    <div id="overlayMaskHeader"></div></div>

    
    
    
    <div id="jumpInfo" style="display: none">非常抱歉。你请求的内容已被删除。将在 1 秒内自动重定向。</div>





<link type="text/css" rel="stylesheet">
<link type="text/css" rel="stylesheet">


    <div id="breadcrumbs" ms.pgarea="body" ms.cmpgrp="breadcrumbs">
        <div id="breadcrumbDesktop" class="breadCrumb">
                        <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/zh-cn/library/dd489441(v=vs.110).aspx" title="Windows Workflow Foundation"></a></span>
                        <span><a href="https://msdn.microsoft.com/zh-cn/library/dd489462(v=vs.110).aspx" title="Windows Workflow Foundation 编程"><span>Windows Workflow Foundation 编程</span></a></span>
                        <span><a href="https://msdn.microsoft.com/zh-cn/library/dd489420(v=vs.110).aspx" title="工作流持久性"><span>工作流持久性</span></a></span>
                        <span class="breadcrumbDropSmall">
                            <a id="breadcrumbDropDownButton" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#" targethref="https://msdn.microsoft.com/zh-cn/library/dd489420(v=vs.110).aspx" title="SQL 工作流实例存储"><span>SQL 工作流实例存储</span></a>
                        </span>
        </div>
        <div id="breadcrumbDropDownMenu" style="display: none;"></div>
        <div id="tocDropDownMenu" style="display: none;"></div>

        <div id="breadcrumbTablet" class="breadCrumb">
                        <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/zh-cn/library/dd489420(v=vs.110).aspx" title="工作流持久性"></a></span>
                    <span><a href="https://msdn.microsoft.com/zh-cn/library/ee383994(v=vs.110).aspx" title="SQL 工作流实例存储"><span>SQL 工作流实例存储</span></a></span>
                <span class="breadcrumbDropSmall"><a id="tocDropDownButton" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#" title="如何：对工作流和工作流服务启用 SQL 持久性"><span>如何：对工作流和工作流服务启用 SQL 持久性</span></a></span>
        <div id="navigationButtons">
            <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/ee395773(d=printer,v=vs.110).aspx" rel="nofollow"><ins class="print"></ins>打印</a>
            <a id="isd_printABook" href="https://msdn.microsoft.com/zh-cn/library/export/help/?returnurl=%2fzh-cn%2flibrary%2fee395773(v%3dvs.110).aspx">
                <ins class="export"></ins>导出 (<span class="count">0</span>)
            </a>
        </div></div>
        <div id="breadcrumbMobile" class="breadCrumb">
                <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/zh-cn/library/ee383994(v=vs.110).aspx" title="SQL 工作流实例存储"></a></span>
            <span class="breadcrumbDropSmall"><a id="tocPopupButton" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#" title="如何：对工作流和工作流服务启用 SQL 持久性"><span>如何：对工作流和工作流服务启用 SQL 持久性</span></a></span>
        <div id="navigationButtons">
            <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/ee395773(d=printer,v=vs.110).aspx" rel="nofollow"><ins class="print"></ins>打印</a>
            <a id="isd_printABook" href="https://msdn.microsoft.com/zh-cn/library/export/help/?returnurl=%2fzh-cn%2flibrary%2fee395773(v%3dvs.110).aspx">
                <ins class="export"></ins>导出 (<span class="count">0</span>)
            </a>
        </div></div>
    </div>
    <div id="tocPopupMenu" style="display: none;">
        <div id="tocPopMenuClose" class="tocCloseLarge"></div>
        <div id="tocTitle">如何：对工作流和工作流服务启用 SQL 持久性</div>        
    </div>

    


        <div id="body" ms.pgarea="body" class="">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="leftNav" ms.cmpgrp="left toc" style="height: auto;">

    



<div id="tocnav" class="hide-archive ArchiveV2">
    <div class="tocunselected">
        <div id="tocExpandArea">
            <span class="toc_empty"></span>
            <span id="tocExpandButton"><a href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#"></a></span>
        </div>
        <div id="tocExpand"></div>
    <div class="toclevel " data-toclevel="1">
<a class="toc_collapsed" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#" aria-label="展开目录"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/zh-cn/library/ee395770(v=vs.110).aspx" id="mt670929_VS.110_zh-cn" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="SQL 工作流实例存储的属性">SQL 工作流实例存储的属性</a>                </div></div>
    <div class="tocselected"><div class="toclevel current" data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="如何：对工作流和工作流服务启用 SQL 持久性">如何：对工作流和工作流服务启用 SQL 持久性</a>                </div><div class="tocPadding"></div></div>
    <div class="tocunselected">
                
                
                <div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/zh-cn/library/ee829473(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="实例激活">实例激活</a>                </div>
                <div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/zh-cn/library/ee364724(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="查询支持">查询支持</a>                </div>
                <div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/zh-cn/library/ee364726(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="存储扩展性">存储扩展性</a>                </div>
                <div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/zh-cn/library/ee829483(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="安全性">安全性</a>                </div>
                <div class="toclevel " data-toclevel="1">
<a class="toc_collapsed" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#" aria-label="展开目录"></a><a data-tochassubtree="true" href="https://msdn.microsoft.com/zh-cn/library/ee960216(v=vs.110).aspx" id="mt670928_VS.110_zh-cn" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="SQL Server 持久性数据库">SQL Server 持久性数据库</a>                </div>
    </div>
    <a id="tocMenuToggler" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#">
        <span id="tocMenuTogglerIcon" class="tocMenuCollapse"></span>
        <div id="tocMenuTogglerLabel">TOC</div>
    </a>
</div>            <div style="display:none">
                <div id="CollapseLocalizeString">折叠目录</div>
                <div id="ExpandLocalizeString">展开目录</div>
            </div>
        <div>
            <a id="isd_archiveControlResponsive" style="display:none;" data-include-archive="显示已存档版本" data-exclude-archive="隐藏已存档版本">
            </a>
            <div id="isd_archiveInstrument" style="display:none">文档已存档，此处的信息可能已过时</div>
        </div>
    </div>
     <div id="content" class="content" ms.cmpgrp="content body">



<div id="MTPSTranslator" class="MTPSTranslator">
    <table class="MTPSTranslatorTable" style="width: 100%">
        <tbody><tr>
            <td class="TranslationAlertBox">
                <div>要查看英语原文，请勾选“英语”复选框。也可将鼠标指针移到文本上，在弹出窗口中显示英语原文。</div>
            </td>
                <td class="TranslationViewSwitcher">
                    <div>
                        <input title="显示译文" value="0" name="TrnaslatorView" type="radio" class="translatechoice" checked="checked"><span>翻译</span>
                    </div>
                    <div>
                        <input title="显示英文" value="1" name="TrnaslatorView" type="radio" class="translatechoice"><span>英语</span>
                    </div>
                </td>
        </tr>
    </tbody></table>
</div>
    
    
    
     







    <div id="archiveDisclaimerText" style="display:none">文档已存档，此处的信息可能已过时</div>



<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">如何：对工作流和工作流服务启用 SQL 持久性</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong>
                .NET Framework (current version)
            </strong>
      </div>
      <div id="versionclick">
        <div id="vsseperator" class="cl_lw_vs_seperator"></div>
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        其他版本
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel" style="display: none;">
          <li class="">
            <a href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.100).aspx">.NET Framework 4</a>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<p>发布时间: 2016年4月</p><div class="introduction"><p><span id="mt1" class="sentence" data-guid="3b1c3f17ea5b9daeee9471e5c1834423" data-source="This topic describes how to configure the SQL Workflow Instance Store feature to enable persistence for your workflows and workflow services both programmatically and by using a configuration file. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">本主题介绍如何通过编程方式以及使用配置文件来配置 SQL 工作流实例存储功能，以便为工作流和工作流服务启用持久性。</sentencetext></span></p><p><span id="mt2" class="sentence SentenceHover" data-guid="81c6b90f1c1f297e51e4f41f6dff4087" data-source="Windows Server App Fabric simplifies the process of configuring persistence." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">Windows Server App Fabric 大大简化了配置持久性的进程。</sentencetext></span><span id="mt3" class="sentence" data-guid="5dcdb9f4aac39c3b9f9edd625bb55fdc" data-source="For more information, see &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;App Fabric Persistence Configuration&lt;/span&gt;&lt;/span&gt;" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">有关详细信息，请参见<a href="http://go.microsoft.com/fwlink/?LinkId=201204">App Fabric 持久性配置</a></sentencetext></span></p><p><span id="mt4" class="sentence" data-guid="6be6de275df9ae23abdcd821e6cebd3a" data-source="Before using the SQL Workflow Instance Store feature, create a database that the feature uses to persist workflow instances." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">使用 SQL 工作流实例存储功能之前，创建一个数据库以供该功能用来持久保存工作流实例。</sentencetext></span><span id="mt5" class="sentence" data-guid="32bedd016abde7ac71ff9d3d370c58b6" data-source="The .NET Framework 4.6.1 set-up program copies SQL script files associated with the SQL Workflow Instance Store feature to the %WINDIR%\Microsoft.NET\Framework\v4.xxx\SQL\EN folder." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">.NET Framework 4.6.1 安装程序将与 SQL 工作流实例存储功能相关联的 SQL 脚本文件复制到 %WINDIR%\Microsoft.NET\Framework\v4.xxx\SQL\EN 文件夹。</sentencetext></span><span id="mt6" class="sentence" data-guid="8aadd30a9d0ec2bc26ec943dd58dd6d5" data-source="Run these script files against a SQL Server 2005 or SQL Server 2008 database that you want the SQL Workflow Instance Store to use to persist workflow instances." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">针对您希望 SQL 工作流实例存储用于持久保存工作流实例的 SQL Server 2005 或 SQL Server 2008 数据库，运行这些脚本文件。</sentencetext></span><span id="mt7" class="sentence" data-guid="43b36ce52685a95628814bcd4d699f88" data-source="Run the SqlWorkflowInstanceStoreSchema.sql file first and then run the SqlWorkflowInstanceStoreLogic.sql file." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">首先运行 SqlWorkflowInstanceStoreSchema.sql 文件，然后运行 SqlWorkflowInstanceStoreLogic.sql 文件。</sentencetext></span></p><div class="alert"><div class="contentTableWrapper"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note" alt="System_CAPS_note" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/IC101471.jpeg" title="System_CAPS_note" xmlns=""></span><span class="alertTitle">注意</span></th></tr><tr><td><p><span id="mt8" class="sentence" data-guid="f811417fea3f49cfdf42625cb70a123e" data-source="To clean up the persistence database to have a fresh database, run the scripts in %WINDIR%\Microsoft.NET\Framework\v4.xxx\SQL\EN in the following order." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">若要清除此持久性数据库以获得一个全新的数据库，请按下列顺序运行 %WINDIR%\Microsoft.NET\Framework\v4.xxx\SQL\EN 中的脚本。</sentencetext></span></p><ol class="ordered"><li><p><span id="mt9" class="sentence" data-guid="6525aec26f357417638a0da00830c637" data-source="SqlWorkflowInstanceStoreSchema.sql" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreSchema.sql</sentencetext></span></p></li><li><p><span id="mt10" class="sentence" data-guid="f237e885f63666d3616ca400302f9777" data-source="SqlWorkflowInstanceStoreLogic.sql" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreLogic.sql</sentencetext></span></p></li></ol></td></tr></tbody></table></div></div><div class="alert"><div class="contentTableWrapper"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-important" alt="System_CAPS_important" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/IC160177.jpeg" title="System_CAPS_important" xmlns=""></span><span class="alertTitle">重要事项 </span></th></tr><tr><td><p><span id="mt11" class="sentence" data-guid="27c241ba06ac3618002f2b178775d00c" data-source="If you do not create a persistence database, the SQL Workflow Instance Store feature throws an exception similar to the following one when a host tries to persist workflows." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">如果不创建持久性数据库，则当宿主尝试持久保存工作流时，SQL 工作流实例存储功能将引发与以下异常类似的异常。</sentencetext></span></p><p><span id="mt12" class="sentence" data-guid="0b8f976be518b6f1e5d4ef8fa37cff9c" data-source="System.Data.SqlClient.SqlException: Could not find stored procedure &#39;System.Activities.DurableInstancing.CreateLockOwner&#39;" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">System.Data.SqlClient.SqlException: 找不到存储过程“System.Activities.DurableInstancing.CreateLockOwner”</sentencetext></span></p></td></tr></tbody></table></div></div><p><span id="mt13" class="sentence" data-guid="0b747aefd60decb192c868d6aa99e2c4" data-source="The following sections describe how to enable persistence for workflows and workflow services using the SQL Workflow Instance Store." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">下面介绍如何使用 SQL 工作流实例存储来为工作流与工作流服务启用持久性。</sentencetext></span><span id="mt14" class="sentence" data-guid="408e729eb871edb18e1b34d43478e837" data-source="For more information about properties of the SQL Workflow Instance Store, see &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;SQL 工作流实例存储的属性&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">SQL 工作流实例存储的 有关以下内容的详细信息 属性，请参见 <a href="https://msdn.microsoft.com/zh-cn/library/ee395770(v=vs.110).aspx">SQL 工作流实例存储的属性</a>。</sentencetext></span></p></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">为使用 WorkflowApplication 的自承载工作流启用持久性</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div active"><a href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p><span id="mt16" class="sentence" data-guid="1bef0add0144951de1b73fa2b6f2e25b" data-source="You can enable persistence for self-hosted workflows that use &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;WorkflowApplication&lt;/span&gt;&lt;/span&gt; programmatically by using the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;SqlWorkflowInstanceStore&lt;/span&gt;&lt;/span&gt; object model." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">可通过使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.durableinstancing.sqlworkflowinstancestore(v=vs.110).aspx">SqlWorkflowInstanceStore</a> 对象模型为以编程方式使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.workflowapplication(v=vs.110).aspx">WorkflowApplication</a> 的自承载工作流启用持久性。</sentencetext></span><span id="mt17" class="sentence" data-guid="e307a92ae3f5def72e25f3e2d6eca67f" data-source="The following procedure contains steps to do this." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">以下过程包含了执行上述操作的步骤。</sentencetext></span></p><div class="section" bookmarktitle="为自承载工作流启用持久性"><h3 class="subHeading" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink"><span id="mt18" class="sentence" data-guid="505731e05e44fb55c72be76695cd474c" data-source="To enable persistence for self-hosted workflows" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">为自承载工作流启用持久性</sentencetext></span></h3><ol class="steps"><li class="step"><div class="section"><p><span id="mt19" class="sentence" data-guid="1c2e6e558fa89bb93636a4957b735044" data-source="Add a reference to System.Activites.DurableInstancing.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">添加对 System.Activites.DurableInstancing.dll 的引用。</sentencetext></span></p></div></li><li class="step"><div class="section"><p><span id="mt20" class="sentence" data-guid="e860e77cb57d888cff77a61bf526307d" data-source="Add the following statement at the top of the source file after the existing &quot;using&quot; statements." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将以下语句添加到源文件顶部的现有“using”语句后面。</sentencetext></span></p>
<div id="code-snippet-1" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C#</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_bd2bb6e9-6b9f-4c78-bfce-f9ce4f98e5f9&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_bd2bb6e9-6b9f-4c78-bfce-f9ce4f98e5f9" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre><span style="color:Blue;">using</span> System.Activities.DurableInstancing;
</pre></div>
            
        </div>
    </div>
</div>
</div></li><li class="step"><div class="section"><p><span id="mt21" class="sentence" data-guid="47605a5153c060128f6c605f20e56b60" data-source="Construct a &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;SqlWorkflowInstanceStore&lt;/span&gt;&lt;/span&gt; and assign it to the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;InstanceStore&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; of the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;WorkflowApplication&lt;/span&gt;&lt;/span&gt; as shown in the following code example." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">如下面的代码示例中所示，构造一个 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.durableinstancing.sqlworkflowinstancestore(v=vs.110).aspx">SqlWorkflowInstanceStore</a>，并将其分配给 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.workflowapplication(v=vs.110).aspx">WorkflowApplication</a> 的 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.workflowapplication.instancestore(v=vs.110).aspx"><span xmlns="">InstanceStore</span></a>。</sentencetext></span></p>
<div id="code-snippet-2" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C#</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_4af30de5-666c-4d55-966c-b231ea5d22ce&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_4af30de5-666c-4d55-966c-b231ea5d22ce" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
SqlWorkflowInstanceStore store = 
    <span style="color:Blue;">new</span> SqlWorkflowInstanceStore(<span style="color:#A31515;">"Server=.\\SQLEXPRESS;Initial Catalog=Persistence;Integrated Security=SSPI"</span>);

WorkflowApplication wfApp =
    <span style="color:Blue;">new</span> WorkflowApplication(<span style="color:Blue;">new</span> Workflow1());

wfApp.InstanceStore = store;

</pre></div>
            
        </div>
    </div>
</div>
<div class="alert"><div class="contentTableWrapper"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note" alt="System_CAPS_note" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/IC101471.jpeg" title="System_CAPS_note" xmlns=""></span><span class="alertTitle">注意</span></th></tr><tr><td><p><span id="mt22" class="sentence" data-guid="303bfca60ceb33a0efe1a8a433003386" data-source="Depending on your edition of SQL Server, the connection string server name may be different." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">根据您的 SQL Server 版本，该连接字符串服务器的名称可能有所不同。</sentencetext></span></p></td></tr></tbody></table></div></div></div></li><li class="step"><div class="section"><p><span id="mt23" class="sentence" data-guid="40c122bf83b5d1f185bd490545530b5c" data-source="Invoke the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Persist&lt;/span&gt;&lt;/span&gt; method on the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;WorkflowApplication&lt;/span&gt;&lt;/span&gt; object to persist a workflow, or &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Unload&lt;/span&gt;&lt;/span&gt; method to persist and unload a workflow." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">对 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.workflowapplication(v=vs.110).aspx">WorkflowApplication</a> 对象调用 <a href="https://msdn.microsoft.com/zh-cn/library/dd988106(v=vs.110).aspx">Persist</a> 方法以持久保存工作流，或者调用 <a href="https://msdn.microsoft.com/zh-cn/library/dd986384(v=vs.110).aspx">Unload</a> 方法以持久保存并卸载工作流。</sentencetext></span><span id="mt24" class="sentence" data-guid="99e3369dfc1408545d1d21b99e117955" data-source="You can also handle the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;PersistableIdle&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; event raised by the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;WorkflowApplication&lt;/span&gt;&lt;/span&gt; object and return appropriate (&lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Persist&lt;/span&gt;&lt;/span&gt; or &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Unload&lt;/span&gt;&lt;/span&gt;) member of &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;PersistableIdleAction&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">还可以处理由 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.workflowapplication(v=vs.110).aspx">WorkflowApplication</a> 对象引发的 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.workflowapplication.persistableidle(v=vs.110).aspx"><span xmlns="">PersistableIdle</span></a> 事件，并返回 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.persistableidleaction(v=vs.110).aspx">PersistableIdleAction</a> 的适当的（<a href="https://msdn.microsoft.com/zh-cn/library/system.activities.persistableidleaction(v=vs.110).aspx">Persist</a> 或 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.persistableidleaction(v=vs.110).aspx">Unload</a>）成员。</sentencetext></span></p>
<div id="code-snippet-3" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C#</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_98469e49-b8a9-4142-a5bc-b409e8b79d01&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_98469e49-b8a9-4142-a5bc-b409e8b79d01" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>wfApp.PersistableIdle = <span style="color:Blue;">delegate</span>(WorkflowApplicationIdleEventArgs e)
{
    <span style="color:Blue;">return</span> PersistableIdleAction.Persist;
};
</pre></div>
            
        </div>
    </div>
</div>
</div></li></ol></div><div class="alert"><div class="contentTableWrapper"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-note" alt="System_CAPS_note" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/IC101471.jpeg" title="System_CAPS_note" xmlns=""></span><span class="alertTitle">注意</span></th></tr><tr><td><p><span id="mt25" class="sentence" data-guid="b45d92361472f827b031b525d30b1ca9" data-source="See the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;持久保存工作流应用程序&lt;/span&gt;&lt;/span&gt; sample at &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;持久性&lt;/span&gt;&lt;/span&gt; for an example of enabling persistence for workflows using the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;SqlWorkflowInstanceStore&lt;/span&gt;&lt;/span&gt;, and the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;如何：创建和运行长时间运行的工作流&lt;/span&gt;&lt;/span&gt; step of the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;入门教程 [.NET Framework 4.5]&lt;/span&gt;&lt;/span&gt; for step by step instructions." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">有关使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.activities.durableinstancing.sqlworkflowinstancestore(v=vs.110).aspx">SqlWorkflowInstanceStore</a> 为工作流启用持久性的示例，请参见<a href="https://msdn.microsoft.com/zh-cn/library/dd699769(v=vs.110).aspx">持久性</a>中的<a href="https://msdn.microsoft.com/zh-cn/library/dd807516(v=vs.110).aspx">持久保存工作流应用程序</a>示例。有关分步说明，请参见<a href="https://msdn.microsoft.com/zh-cn/library/dd489454(v=vs.110).aspx">入门教程 [.NET Framework 4.5]</a>中的<a href="https://msdn.microsoft.com/zh-cn/library/dd489452(v=vs.110).aspx">如何：创建和运行长时间运行的工作流</a>步骤。</sentencetext></span></p></td></tr></tbody></table></div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">为使用 WorkflowServiceHost 的自承载工作流服务启用持久性</span></a><div id="Anchor_1" class="LW_CollapsibleArea_Anchor_Div"><a href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#Anchor_1" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p><span id="mt27" class="sentence" data-guid="ed98b7e3f14b34aff7518dfd553b5e38" data-source="You can enable persistence for self-hosted workflow services that use &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;WorkflowServiceHost&lt;/span&gt;&lt;/span&gt; programmatically by using the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt;&lt;/span&gt; class or the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;DurableInstancingOptions&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; class. " xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">可通过使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.servicemodel.activities.description.sqlworkflowinstancestorebehavior(v=vs.110).aspx">SqlWorkflowInstanceStoreBehavior</a> 类或者 <a href="https://msdn.microsoft.com/zh-cn/library/system.servicemodel.activities.workflowservicehost.durableinstancingoptions(v=vs.110).aspx"><span xmlns="">DurableInstancingOptions</span></a> 类为以编程方式使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.servicemodel.workflowservicehost(v=vs.110).aspx">WorkflowServiceHost</a> 的自承载工作流服务启用持久性。</sentencetext></span></p></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">使用 SqlWorkflowInstanceStoreBehavior 类</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p><span id="mt29" class="sentence" data-guid="299ca5320f27f186365371681ba1f06a" data-source="The following procedure contains steps to use the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt;&lt;/span&gt; class to enable persistence for self-hosted workflow services." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">以下过程包含使用 <a href="https://msdn.microsoft.com/zh-cn/library/system.servicemodel.activities.description.sqlworkflowinstancestorebehavior(v=vs.110).aspx">SqlWorkflowInstanceStoreBehavior</a> 类来为自承载工作流服务启用持久性的步骤。</sentencetext></span></p><div class="section" bookmarktitle="使用 SqlWorkflowInstanceStoreBehavior 启用持久性"><h4 class="subHeading" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink"><span id="mt30" class="sentence" data-guid="2b54968e34735da1525f8f094e6207de" data-source="To enable persistence using SqlWorkflowInstanceStoreBehavior" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">使用 SqlWorkflowInstanceStoreBehavior 启用持久性</sentencetext></span></h4><ol class="steps"><li class="step"><div class="section"><p><span id="mt31" class="sentence" data-guid="510f664fd13e6d1c2531aa5b9d09aec7" data-source="Add a reference to the System.ServiceModel.dll." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">添加对 System.ServiceModel.dll 的引用。</sentencetext></span></p></div></li><li class="step"><div class="section"><p><span id="mt32" class="sentence" data-guid="e860e77cb57d888cff77a61bf526307d" data-source="Add the following statement at the top of the source file after the existing &quot;using&quot; statements." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将以下语句添加到源文件顶部的现有“using”语句后面。</sentencetext></span></p>
<div id="code-snippet-4" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C#</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_fba3be85-e96d-4e8d-9652-42a3af4043c3&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_fba3be85-e96d-4e8d-9652-42a3af4043c3" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre><span style="color:Blue;">using</span> System.ServiceModel.Activities.Description;
</pre></div>
            
        </div>
    </div>
</div>
</div></li><li class="step"><div class="section"><p><span id="mt33" class="sentence" data-guid="8fc1f151ea0e9ef21fd229e4613808a8" data-source="Create an instance of the &lt;span class=&quot;code&quot;&gt;WorkflowServiceHost&lt;/span&gt; and add endpoints for the workflow service." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">创建一个 <span class="code" xmlns="http://www.w3.org/1999/xhtml">WorkflowServiceHost</span> 实例，并为该工作流服务添加终结点。</sentencetext></span></p>
<div id="code-snippet-5" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_930385f3-b6cc-4ce5-97af-4a52d42d68e6&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_930385f3-b6cc-4ce5-97af-4a52d42d68e6" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
WorkflowServiceHost host = new WorkflowServiceHost(new CountingWorkflow(), new Uri(hostBaseAddress));
host.AddServiceEndpoint("ICountingWorkflow", new BasicHttpBinding(), "");

</pre></div>
            
        </div>
    </div>
</div>
</div></li><li class="step"><div class="section"><p><span id="mt34" class="sentence" data-guid="0f162afcbdf8697ae9718017ba3f9c5c" data-source="Construct a &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt; object and to set properties of the behavior object." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">构造一个 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreBehavior</span> 对象，并设置该行为对象的属性。</sentencetext></span></p>
<div id="code-snippet-6" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C#</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_80248237-9877-44b2-bb3b-94e759b1b99c&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_80248237-9877-44b2-bb3b-94e759b1b99c" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
SqlWorkflowInstanceStoreBehavior instanceStoreBehavior = <span style="color:Blue;">new</span> SqlWorkflowInstanceStoreBehavior(connectionString);
instanceStoreBehavior.HostLockRenewalPeriod = <span style="color:Blue;">new</span> TimeSpan(0, 0, 5);
instanceStoreBehavior.InstanceCompletionAction = InstanceCompletionAction.DeleteAll;
instanceStoreBehavior.InstanceLockedExceptionAction = InstanceLockedExceptionAction.AggressiveRetry;
instanceStoreBehavior.InstanceEncodingOption = InstanceEncodingOption.GZip;
instanceStoreBehavior.RunnableInstancesDetectionPeriod = <span style="color:Blue;">new</span> TimeSpan(<span style="color:#A31515;">"00:00:02"</span>);
host.Description.Behaviors.Add(instanceStoreBehavior);

</pre></div>
            
        </div>
    </div>
</div>
</div></li><li class="step"><div class="section"><p><span id="mt35" class="sentence" data-guid="c8a39da3cc8224eb72a183cc7b2e1566" data-source="Open the workflow service host." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">打开工作流服务宿主。</sentencetext></span></p>
<div id="code-snippet-7" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>VB</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_c175b511-fd2b-4349-abff-55d13ca63882&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_c175b511-fd2b-4349-abff-55d13ca63882" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
host.Open();

</pre></div>
            
        </div>
    </div>
</div>
</div></li></ol></div><div class="alert"><div class="contentTableWrapper"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-important" alt="System_CAPS_important" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/IC160177.jpeg" title="System_CAPS_important" xmlns=""></span><span class="alertTitle">重要事项 </span></th></tr><tr><td><p><span id="mt36" class="sentence" data-guid="9f6a698fed5103d644b94eb73e058c5e" data-source="See the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;内置配置&lt;/span&gt;&lt;/span&gt; sample at &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;持久性&lt;/span&gt;&lt;/span&gt; for an example of enabling persistence for workflow services using the &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt; class." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">有关使用 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreBehavior</span> 类为工作流服务启用持久性的示例，请参见<a href="https://msdn.microsoft.com/zh-cn/library/dd699769(v=vs.110).aspx">持久性</a>中的<a href="https://msdn.microsoft.com/zh-cn/library/ee622978(v=vs.110).aspx">内置配置</a>示例。</sentencetext></span></p></td></tr></tbody></table></div></div></div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">使用 DurableInstancingOptions 属性</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p><span id="mt38" class="sentence" data-guid="8ca82add349a42e6f8c545eed2d99bad" data-source="When the &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt; is applied, the &lt;span class=&quot;code&quot;&gt;DurableInstancingOptions.InstanceStore&lt;/span&gt; on the &lt;span class=&quot;code&quot;&gt;WorkflowServiceHost&lt;/span&gt; is set to the &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStore&lt;/span&gt; object created using the configuration values." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">应用 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreBehavior</span> 时，<span class="code" xmlns="http://www.w3.org/1999/xhtml">WorkflowServiceHost</span> 上的 <span class="code" xmlns="http://www.w3.org/1999/xhtml">DurableInstancingOptions.InstanceStore</span> 设置为使用配置值创建的 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStore</span> 对象。</sentencetext></span><span id="mt39" class="sentence" data-guid="eb289bfb81297f21c200805e156f1fd8" data-source="You can do the same programmatically to set the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;&lt;span class=&quot;mtpsTagOuterHtml&quot;  xmlns=&quot;&quot;&gt;&lt;span&gt;DurableInstancingOptions&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; property of the &lt;span class=&quot;code&quot;&gt;WorkflowServiceHost&lt;/span&gt; without using the &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt; class as shown in the following code example." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">如下面的代码示例中所示，您可以通过编程方式设置 <span class="code" xmlns="http://www.w3.org/1999/xhtml">WorkflowServiceHost</span> 的 <a href="https://msdn.microsoft.com/zh-cn/library/system.servicemodel.activities.workflowservicehost.durableinstancingoptions(v=vs.110).aspx"><span xmlns="">DurableInstancingOptions</span></a> 属性（而不使用 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreBehavior</span> 类）来达到相同目的。</sentencetext></span></p>
<div id="code-snippet-8" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_5ef10079-53a9-402e-abff-10069976b757&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_5ef10079-53a9-402e-abff-10069976b757" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>workflowServiceHost.DurableInstancingOptions.InstanceStore = sqlInstanceStoreObject;
</pre></div>
            
        </div>
    </div>
</div>
</div></div></div></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">使用配置文件为使用 WorkflowServiceHost 的 WAS 承载工作流服务启用持久性</span></a><div id="Anchor_2" class="LW_CollapsibleArea_Anchor_Div"><a href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#Anchor_2" class="LW_CollapsibleArea_Anchor_Img" title="右键单击以复制并共享此部分的链接"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><div class="section"><p><span id="mt41" class="sentence" data-guid="6713abc2fd4a232d68edaf2fa07ffacf" data-source="You can enable persistence for self-hosted or Windows Process Activation Service (WAS)-hosted workflow services by using a configuration file." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">可使用配置文件为自承载或 Windows 进程激活服务 (WAS) 承载的工作流服务启用持久性。</sentencetext></span><span id="mt42" class="sentence" data-guid="c17c0277d65e755ee259a716174f7231" data-source="A WAS-hosted workflow service uses the WorkflowServiceHost as the self-hosted workflow services do." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">WAS 承载的工作流服务与自承载工作流服务一样，都使用 WorkflowServiceHost。</sentencetext></span></p><p><span id="mt43" class="sentence" data-guid="6b7e3ac1c8b663e3d7ccfc769a3d12e2" data-source="The &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt;, a service behavior that allows you to conveniently change the &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;SQL 工作流实例存储&lt;/span&gt;&lt;/span&gt; properties through XML configuration." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">
  <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreBehavior</span> 是一个服务行为，可用于通过 XML 配置方便地更改 <a href="https://msdn.microsoft.com/zh-cn/library/ee383994(v=vs.110).aspx">SQL 工作流实例存储</a>属性。</sentencetext></span><span id="mt44" class="sentence" data-guid="a8b2fa9da0c3ca080e12d72d0a24ac5d" data-source="For WAS-hosted workflow services, use the Web.config file." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">对于 WAS 承载的工作流服务，请使用 Web.config 文件。</sentencetext></span><span id="mt45" class="sentence" data-guid="17f4b2961e21f8cd46c762666715869b" data-source="The following configuration example shows how to configure the SQL Workflow Instance Store by using the &lt;span class=&quot;code&quot;&gt;sqlWorkflowInstanceStore&lt;/span&gt; behavior element in a configuration file." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">下面的配置示例演示如何使用配置文件中的 <span class="code" xmlns="http://www.w3.org/1999/xhtml">sqlWorkflowInstanceStore</span> 行为元素来配置 SQL 工作流实例存储。</sentencetext></span></p>
<div id="code-snippet-9" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_56847baf-fe71-4aea-b723-c76d3932d7c3&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_56847baf-fe71-4aea-b723-c76d3932d7c3" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
&lt;serviceBehaviors&gt;
    &lt;behavior name=""&gt;
        &lt;sqlWorkflowInstanceStore 
                    connectionString="Data Source=(local);Initial Catalog=DefaultPersistenceProviderDb;Integrated Security=True;Async=true"
                    instanceEncodingOption="GZip | None"
                    instanceCompletionAction="DeleteAll | DeleteNothing"
                    instanceLockedExceptionAction="NoRetry | BasicRetry |AggressiveRetry"
                    hostLockRenewalPeriod="00:00:30" 
                    runnableInstancesDetectionPeriod="00:00:05"&gt;

        &lt;sqlWorkflowInstanceStore/&gt;
    &lt;/behavior&gt;
&lt;/serviceBehaviors&gt;

</pre></div>
            
        </div>
    </div>
</div>
<p><span id="mt46" class="sentence" data-guid="c50a7eedcafbb4e8697c3fa7d59f1da7" data-source="If you do not set values for the &lt;span class=&quot;code&quot;&gt;connectionString&lt;/span&gt; or the &lt;span class=&quot;code&quot;&gt;connectionStringName&lt;/span&gt; property, the SQL Workflow Instance Store uses the default named connection string &lt;span class=&quot;code&quot;&gt;DefaultSqlWorkflowInstanceStoreConnectionString&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">如果没有设置 <span class="code" xmlns="http://www.w3.org/1999/xhtml">connectionString</span> 或 <span class="code" xmlns="http://www.w3.org/1999/xhtml">connectionStringName</span> 属性的值，则 SQL 工作流实例存储将使用默认命名连接字符串 <span class="code" xmlns="http://www.w3.org/1999/xhtml">DefaultSqlWorkflowInstanceStoreConnectionString</span>。</sentencetext></span></p><p><span id="mt47" class="sentence" data-guid="8ca82add349a42e6f8c545eed2d99bad" data-source="When the &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStoreBehavior&lt;/span&gt; is applied, the &lt;span class=&quot;code&quot;&gt;DurableInstancingOptions.InstanceStore&lt;/span&gt; on the &lt;span class=&quot;code&quot;&gt;WorkflowServiceHost&lt;/span&gt; is set to the &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStore&lt;/span&gt; object created using the configuration values." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">应用 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStoreBehavior</span> 时，<span class="code" xmlns="http://www.w3.org/1999/xhtml">WorkflowServiceHost</span> 上的 <span class="code" xmlns="http://www.w3.org/1999/xhtml">DurableInstancingOptions.InstanceStore</span> 设置为使用配置值创建的 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStore</span> 对象。</sentencetext></span><span id="mt48" class="sentence" data-guid="9ffa152b5a7ad173adaaceffb0396747" data-source="You can do the same programmatically to use the &lt;span class=&quot;code&quot;&gt;SqlWorkflowInstanceStore&lt;/span&gt; with &lt;span class=&quot;code&quot;&gt;WorkflowServiceHost&lt;/span&gt; without using the service behavior element." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">可以通过编程方式将 <span class="code" xmlns="http://www.w3.org/1999/xhtml">SqlWorkflowInstanceStore</span> 与 <span class="code" xmlns="http://www.w3.org/1999/xhtml">WorkflowServiceHost</span> 一起使用，而不使用服务行为元素来达到相同目的。</sentencetext></span></p>
<div id="code-snippet-10" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_24aa5aa4-3d36-45b6-a967-1461353e44b9&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_24aa5aa4-3d36-45b6-a967-1461353e44b9" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>workflowServiceHost.DurableInstancingOptions.InstanceStore = sqlInstanceStoreObject;
</pre></div>
            
        </div>
    </div>
</div>
<div class="alert"><div class="contentTableWrapper"><table><tbody><tr><th align="left"><span><img id="s-e6f6a65cf14f462597b64ac058dbe1d0-system-media-system-caps-security" alt="System_CAPS_security" src="./如何：对工作流和工作流服务启用 SQL 持久性_files/IC17938.jpeg" title="System_CAPS_security" xmlns=""></span><span class="alertTitle">
        安全性注意</span></th></tr><tr><td><p><span id="mt49" class="sentence" data-guid="46dd72d03da807a81f6929441da06fc3" data-source="It is recommended that you do not store sensitive information such as user names and passwords in the Web.config file." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">建议不要在 Web.config 文件中存储敏感信息，如用户名和密码。</sentencetext></span><span id="mt50" class="sentence" data-guid="e990414cc819a4e88c5b58b5851ef6eb" data-source="If you do store sensitive information in the Web.config file, you should secure access to the Web.config file by using file system Access Control Lists (ACLs)." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">如果在 Web.config 文件中存储了敏感信息，应使用文件系统访问控制列表 (ACL) 来确保安全访问 Web.config 文件。</sentencetext></span><span id="mt51" class="sentence" data-guid="99971134cd11f58abeef888d6ef66578" data-source="In addition, you can also secure the configuration values within a configuration file as mentioned in &lt;span class=&quot;mtpsTagOuterHtml&quot; &gt;&lt;span&gt;Encrypting Configuration Information Using Protected Configuration&lt;/span&gt;&lt;/span&gt;." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">此外，还可以保护配置文件中的配置值的安全，如<a href="http://go.microsoft.com/fwlink/?LinkId=178419">使用受保护的配置加密配置信息</a>（可能为英文网页）中所述。</sentencetext></span></p></td></tr></tbody></table></div></div></div><div><h3 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="折叠" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">与 SQL 工作流实例存储功能相关的 Machine.config 元素</span></a><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h3><div class="sectionblock"><div class="section"><p><span id="mt53" class="sentence" data-guid="5087cac9cd60c0271d6f4983feb65237" data-source="The .NET Framework 4.6.1 installation adds the following elements related to the SQL Workflow Instance Store feature to the Machine.config file:" xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">.NET Framework 4.6.1 安装将以下与 SQL 工作流实例存储功能相关的元素添加到 Machine.config 文件中：</sentencetext></span></p><ul class="unordered"><li><p><span id="mt54" class="sentence" data-guid="1ab3e2582ff95f9208078f35ebbb3131" data-source="Adds the following behavior extension element to the Machine.config file so that you can use the &amp;lt;&lt;span class=&quot;code&quot;&gt;sqlWorkflowInstanceStore&lt;/span&gt;&amp;gt; service behavior element in the configuration file to configure persistence for your services." xml:space="preserve"><sentencetext xmlns="http://www.w3.org/1999/xhtml">将以下行为扩展元素添加到 Machine.config 文件中，以便可以使用配置文件中的 &lt;<span class="code" xmlns="http://www.w3.org/1999/xhtml">sqlWorkflowInstanceStore</span>&gt; 服务行为元素来为服务配置持久性。</sentencetext></span></p>
<div id="code-snippet-11" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="复制到剪贴板。" href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode(&#39;CodeSnippetContainerCode_a490d750-6875-48cd-9acf-f420c566193b&#39;);" ms.cmptyp="CodeSnippet">复制</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_a490d750-6875-48cd-9acf-f420c566193b" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>
&lt;configuration&gt;
    &lt;system.serviceModel&gt;
        &lt;extensions&gt;
            &lt;behaviorExtensions&gt;
                &lt;add name="sqlWorkflowInstanceStore" type="System.Activities.DurableInstancing.SqlWorkflowInstanceStoreElement, System.Activities.DurableInstancing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" /&gt;
            &lt;/behaviorExtensions&gt;
        &lt;/extensions&gt;
    &lt;system.serviceModel&gt;
&lt;configuration&gt;

</pre></div>
            
        </div>
    </div>
</div>
</li></ul></div></div></div></div></div></div>
    </div>
  </div>
</div>






<div class="libraryMemberFilter">
    <div class="filterContainer">
        <span>显示:</span>
        <label>
            <input type="checkbox" class="libraryFilterInherited" checked="checked" value="Inherit">继承
        </label>
        <label>
            <input type="checkbox" class="libraryFilterProtected" checked="checked" value="Protected">保护
        </label>
    </div>
</div>
    
<input type="hidden" id="libraryMemberFilterEmptyWarning" value="您当前的筛选设置无成员可用。">



    </div>
<div id="rightNavigationMenu" ms.cmpgrp="right nav">
    <div id="mobileButtons">
        
    </div>
    <div id="navMain">
        <div id="closeNavigation">
            <a class="tocCloseSmall" id="closeButton"></a>
        </div>
        <div id="navigationButtons">
            <a id="isd_print" href="https://msdn.microsoft.com/zh-cn/library/ee395773(d=printer,v=vs.110).aspx" rel="nofollow"><ins class="print"></ins>打印</a>
            <a id="isd_printABook2" href="https://msdn.microsoft.com/zh-cn/library/export/help/?returnurl=%2fzh-cn%2flibrary%2fee395773(v%3dvs.110).aspx">
                <ins class="export"></ins>导出 (<span class="count">0</span>)
            </a>
            <a id="isdShare" href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#">
                <ins class="share"></ins>共享
            </a>
            <div id="socials" style="display: none">
                <a class="isdFacebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmsdn.microsoft.com%2Fzh-cn%2Flibrary%2Fee395773(v%3Dvs.110).aspx">
                    <ins class="facebook"></ins>
                </a>
                <a class="isdTwitter" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fmsdn.microsoft.com%2Fzh-cn%2Flibrary%2Fee395773(v%3Dvs.110).aspx&amp;text=%E5%A6%82%E4%BD%95%EF%BC%9A%E5%AF%B9%E5%B7%A5%E4%BD%9C%E6%B5%81%E5%92%8C%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%90%AF%E7%94%A8%20SQL%20%E6%8C%81%E4%B9%85%E6%80%A7&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Fmsdn.microsoft.com%2Fzh-cn%2Flibrary%2Fee395773(v%3Dvs.110).aspx">
                    <ins class="twitter"></ins>
                </a>
                <a class="isdGooglePlus" href="https://plus.google.com/share?url=https%3A%2F%2Fmsdn.microsoft.com%2Fzh-cn%2Flibrary%2Fee395773(v%3Dvs.110).aspx">
                    <ins class="googlePlus"></ins>
                </a>
            </div>
        </div>
        <div id="indoc_toc" style="" ms.cmpgrp="indoc toc">
            <div id="indoc_title">本文内容</div>
            <ul id="indoc_toclist"><li data-index="0" class="active">为使用 WorkflowApplication 的自承载工作流启用持久性</li><li data-index="1">为使用 WorkflowServiceHost 的自承载工作流服务启用持久性</li><li data-index="2">使用配置文件为使用 WorkflowServiceHost 的 WAS 承载工作流服务启用持久性</li></ul>
        </div>
    </div>
</div>
<div id="rightNavigationMenuThumbnail" class="rightNavigationMenuThumbnail">
</div>





        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="cG15Y0AYuybOh3Se6An1hJG1blVcvPJS1-zrxOgQxlt098v6HxYXSAECZDKTBixeulKdmp3yldwucUzX7UokkemKfcE1">
<input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/rate/ee395773(v=vs.110).aspx">
<input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/zh-cn/library/feedback/additional/ee395773(v=vs.110).aspx">
<input id="isTopicRated" type="hidden" value="false">




    <div id="lib-footer">
        

    
    <link type="text/css" rel="stylesheet">
    
        
    <div id="ux-footer" class="" style="" dir="ltr">


    <div id="standardRatingBefore" class="clear stdr-container-before"></div>
    <div id="standardRating" class="stdr-container stdr-float" ms.pgarea="body" style="width: 1349px; margin-left: 0px; display: block;">
        <div class="stdr-close" style="display: block;"></div>
        <div class="stdr-vote stdr-content">
            <div class="stdr-content">
                <span class="stdr-votetitle">此页面有帮助吗？</span>
                <button class="stdr-yes" aria-label="是，此页面很有帮助">是</button>
                <button class="stdr-no" aria-label="不，此页面没有任何帮助">否</button>
                <input id="s_ratingValue" type="hidden" value="">
            </div>
        </div>
        <div class="stdr-feedback" style="display: none">
            <div class="stdr-form">
                <div class="stdr-fieldtitle">更多反馈？</div>
                <textarea class="stdr-detail" rows="6" maxlength="1500"></textarea>
                <div>
                    <span class="stdr-count"><span class="stdr-charcnt">1500</span> 个剩余字符</span>
                    <div class="stdr-buttons">
                        <button class="stdr-provide" aria-label="提交我的其他反馈">提交</button>
                        <button class="stdr-skip" aria-label="跳过其他反馈">跳过此步</button>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
        <div class="stdr-thanks" style="display: none">
            <div class="stdr-content">
                <span class="stdr-thankyou">谢谢！</span>
                <span class="stdr-appreciate">我们非常感谢您的反馈。</span>
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
    <div id="standardRatingPlaceholder" style="height: 60px;"></div>
    

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">开发人员中心</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/zh-cn/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">更多...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">学习资源</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft 虚拟学院</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">第 9 频道</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN 杂志</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">社区</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/zh-cn/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">论坛</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">博客</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">支持</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">自助支持</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml" class="nth-child-4n">
  
  <div class="linkList">
    <div class="linkListTitle">计划</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark（针对新创企业）</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">创新杯</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/zh-cn/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fzh-cn%2flibrary%2fee395773(v%3dvs.110).aspx">
        <a href="https://msdn.microsoft.com/zh-cn/library/ee395773(v=vs.110).aspx#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="更改您的语言">中国 (简体中文)</a>
    </form>


            </span>

            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">新闻稿</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">隐私&amp; Cookie</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">使用条款</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">商标</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright">© 2016 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>


        <div class="footerPrintView">
            <div class="footerCopyrightPrintView">© 2016 Microsoft</div>
        </div>

        
        

        
        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17">



        <input id="MtpsDevice" type="hidden" value="Default">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

        
        
        
            
        

<!--[CDATA[ WebTrends view model not available or IncludeLegacyWebTrendsScriptInGlobal feature flag is off]]-->




<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="MyN-ARrEln7gCu19CBYwedCPZEcSuKTpJKhJrpkP81F5ajsUvmnPuf6yuoRHka_5gBeMRSUGtuqfd2jjRM3TPIjETws1">
</div>


    </div>

    
    

    

    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:Breadcrumbs,4:LibraryRightNavigationMenu,4:PrintExportButton,5:StandardRating,2:Footer,0:Topic,0:AppInsightsPerf,3:ResponsiveToc,0:ABTestControl,4:WEDCS,3:CmpgrpForHeader,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Library/Content:3,/Areas/Library/Themes/Base/Content:4,/Areas/Global/Content:5\u0026amp;hashKey=1B894EBBF890AD261C790EE8B410EC3C\u0026amp;v=13642BFC50B7F8761A3CDC1326DABA8D" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026minimumTermLength=2\u0026pgArea=header\u0026brand=Msdn\u0026loc=zh-cn\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=搜索 MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Areas/Epx/Themes/Base/Content/JumpRedirect.js" },
	{ txt: "//\n    MTPS = window.MTPS || {};\n    MTPS.Translation = window.MTPS.Translation || {};\n\n    MTPS.Translation.TranslationType =  0;\n    \n    \n        \n        MTPS.Translation.EditorLink = {\n            includeEditor : 0,\n            editLink: \"https://msdn.microsoft.com/zh-cn/library/translation/edit/ee395773(v=vs.110).aspx\",\n            editLinkText: \"建议更好的翻译\"\n        };\n        \n    //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:jquery.popup,0:Translator;/Areas/Library/Content:0\u0026amp;hashKey=16D24150BAC1A18066CEC17E9B28E03E\u0026amp;v=13642BFC50B7F8761A3CDC1326DABA8D" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027展开\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027折叠\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027单击以展开。双击以全部展开。\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027单击以折叠。双击以全部折叠。\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027全部展开\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027全部折叠\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:LibraryMemberFilter,1:Toc_Fixed,1:CodeSnippet,1:TopicNotInScope,0:ResponsiveSupport,1:VersionSelector,1:SurveyBroker;/Areas/Library/Content:0,/Areas/Epx/Content/Scripts:1\u0026amp;hashKey=47E182D3D8C308F8FDBFA84F991BBB2F\u0026amp;v=13642BFC50B7F8761A3CDC1326DABA8D" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>

<div id="overlayMask"></div><div id="popup-loading0" class="popup-loading" style="display: none; z-index: 210; width: auto; height: auto; left: 305px; top: 324px;">loading...</div><div id="popup0" class="MTPopup" style="z-index: 210; width: auto; height: auto; max-width: 358px; left: 305px; top: 324px; display: block;"><div class="popup-main" style="z-index: 210;"><div class="popup-inner">Windows Server App Fabric simplifies the process of configuring persistence.<div class="EditTranslation"><a href="https://msdn.microsoft.com/zh-cn/library/translation/edit/ee395773(v=vs.110).aspx?sentenceGuid=81c6b90f1c1f297e51e4f41f6dff4087">建议更好的翻译</a></div></div></div></div></body></html>